[
  {
    "objectID": "webppl vs memo/webppl.html",
    "href": "webppl vs memo/webppl.html",
    "title": "",
    "section": "",
    "text": "Cards\n\nlibrary(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.1     ✔ stringr   1.5.2\n✔ ggplot2   4.0.0     ✔ tibble    3.3.0\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.1.0     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nalice_chooses_card_model &lt;- '\nvar alice_chooses_card = function() {\n   var card = sample(Categorical({ vs: [1,2,3] }))\n   return card\n}\nvar dist = Infer(alice_chooses_card)\nexpectation(dist)\n'\nalice_chooses_card_E &lt;- rwebppl::webppl(alice_chooses_card_model)\n\nusing webppl version: v0.9.15 /Users/jacobzimmerman/ucsd/fyp/memo-sandbox/.pixi/envs/default/lib/R/library/rwebppl/js/webppl\n\n\n\nshow(alice_chooses_card_E)\n\n[1] 2\n\n\n\n\nBasic conditioning\n\n\nlibrary(tidyverse)\nbasic_inference_model &lt;- '\nvar model = function() {\n   // uniform prior of true value, discretized for parity with memo\n   var value = randomInteger(101) / 100; // uniform(0, 1)\n\n   // someone has observed that value is &gt;.5\n   condition(value &gt; .5)\n   \n   // return the estimated probability of each possible value\n   return value\n}\nvar dist = Infer(model)\ndist\n\n// alternatively, output the expected value:\n// expectation(dist)\n'\nposterior &lt;- rwebppl::webppl(basic_inference_model) |&gt;\n   arrange(support)\n\n# extra: could compute E of posterior manually like this\n# posteriorE &lt;- sum(as.numeric(posterior$prob) * as.numeric(posterior$support))\n# posteriorE\n\nposterior |&gt;\n   # fill in missing support (HACK: need to round support values to ensure compatibility when calling `complete`)\n   mutate(support = round(support, 3)) |&gt;\n   complete(support = seq(0, 1, by = 0.01) |&gt; round(3), fill = list(prob = 0)) |&gt;\n   ggplot() + geom_line(aes(x=support, y=prob)) + lims(x=c(0,1), y=c(0, NA))"
  },
  {
    "objectID": "webppl vs memo/index.html#memo",
    "href": "webppl vs memo/index.html#memo",
    "title": "",
    "section": "memo",
    "text": "memo"
  },
  {
    "objectID": "webppl vs memo/memo.html",
    "href": "webppl vs memo/memo.html",
    "title": "Basic conditioning",
    "section": "",
    "text": "Cards\n\n# adapted from https://github.com/kach/memo/blob/main/demo/Memonomicon.ipynb\nimport jax\nimport jax.numpy as np\nfrom memo import memo\n\ncards = np.array([1, 2, 3])\n\n@memo(save_comic=\"cards-comic\")\ndef alice_chooses_card_E():\n    alice: chooses(c in cards, wpp=1)\n    return E[alice.c]\n\n# Comic representation of the modeling: ./cards-comic.png\n\n\nprint(alice_chooses_card_E())\n\n2.0\n\n\n\nfrom memo import memo\nimport jax.numpy as np\n\npossible_values = np.array(range(1,101)) / 100\n\n@memo(save_comic=\"memo-comic\")\ndef model[query_v: possible_values]():\n    # establish prior in the observer's frame: that a value generator has some value from .01 to 1\n    value_gen: given(v in possible_values, wpp=1)\n    \n    # push an observation into a valuator's frame:\n    # first, establish the prior in the valuator's frame: have the valuator model that the value generator chose a value uniformly at random\n    valuator: thinks[ value_gen: given(v in possible_values, wpp=1) ]\n    # then, now that the value is modeled by the valuator, condition that value\n    valuator: observes_that [value_gen.v &gt; .5]\n\n    # return the estimated probability of the generator's value for being each queried v, *estimated according to the valuator/from the valuator's frame*\n    valuator: knows(query_v) # first, push query_v into the frame of the valuator\n    return valuator[Pr[value_gen.v == query_v]]\n\n    # or return the expected value in the valuator's frame:\n    # return valuator[E[value_gen.v]]\n\n# Comic representation of the modeling: ./memo-comic.png\n\n\nfrom matplotlib import pyplot as plt\nplt.plot(possible_values, model())"
  }
]